<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Practice: Learning on the Battle Field | My Project</title>
  <meta name="description" content="The webpages are mainly about my stats project." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Practice: Learning on the Battle Field | My Project" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The webpages are mainly about my stats project." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Practice: Learning on the Battle Field | My Project" />
  
  <meta name="twitter:description" content="The webpages are mainly about my stats project." />
  

<meta name="author" content="Bill Last Updated:" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="project-draft.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://williamdingpullman.github.io/" target="blank">Bill's Stats Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: Motivation</a></li>
<li class="chapter" data-level="1" data-path="practice-learning-on-the-battle-field.html"><a href="practice-learning-on-the-battle-field.html"><i class="fa fa-check"></i><b>1</b> Practice: Learning on the Battle Field</a><ul>
<li class="chapter" data-level="1.1" data-path="practice-learning-on-the-battle-field.html"><a href="practice-learning-on-the-battle-field.html#r-code"><i class="fa fa-check"></i><b>1.1</b> R code</a></li>
<li class="chapter" data-level="1.2" data-path="practice-learning-on-the-battle-field.html"><a href="practice-learning-on-the-battle-field.html#references"><i class="fa fa-check"></i><b>1.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="project-draft.html"><a href="project-draft.html"><i class="fa fa-check"></i><b>2</b> Project Draft</a><ul>
<li class="chapter" data-level="2.1" data-path="project-draft.html"><a href="project-draft.html#background"><i class="fa fa-check"></i><b>2.1</b> Background</a></li>
<li class="chapter" data-level="2.2" data-path="project-draft.html"><a href="project-draft.html#important-examples-with-r-code"><i class="fa fa-check"></i><b>2.2</b> Important Examples with R code</a></li>
<li class="chapter" data-level="2.3" data-path="project-draft.html"><a href="project-draft.html#references-1"><i class="fa fa-check"></i><b>2.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="newton-raphson-intercept.html"><a href="newton-raphson-intercept.html"><i class="fa fa-check"></i><b>3</b> Newton Raphson - Intercept</a></li>
<li class="chapter" data-level="4" data-path="the-main-one.html"><a href="the-main-one.html"><i class="fa fa-check"></i><b>4</b> The Main One</a><ul>
<li class="chapter" data-level="4.1" data-path="the-main-one.html"><a href="the-main-one.html#the-basic-idea"><i class="fa fa-check"></i><b>4.1</b> The Basic Idea</a></li>
<li class="chapter" data-level="4.2" data-path="the-main-one.html"><a href="the-main-one.html#model-and-r-code"><i class="fa fa-check"></i><b>4.2</b> Model and R Code</a></li>
<li class="chapter" data-level="4.3" data-path="the-main-one.html"><a href="the-main-one.html#glmmtmb-package"><i class="fa fa-check"></i><b>4.3</b> glmmTMB package</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.williamsding.com/" target="blank">Bill's website</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">My Project</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="practice-learning-on-the-battle-field" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Practice: Learning on the Battle Field</h1>
<div id="r-code" class="section level2">
<h2><span class="header-section-number">1.1</span> R code</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#https://fivethirtyeight.com/contributors/josh-hermsmeyer/</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co"># https://github.com/ryurko/nflscrapR-data/blob/master/legacy_data/README.md</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#mydata1 = read.csv(&#39;plays.txt&#39;)</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#unique(mydata1$gameId)</span></a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#unique(mydata1$PassLength)</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#table(mydata1$PassLength)</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#table(mydata1$PassResult)</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#table(mydata1$numberOfPassRushers)</span></a>
<a class="sourceLine" id="cb1-11" title="11"></a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">##mydata3 = read.csv(url(&#39;https://raw.githubusercontent.com/ryurko/nflscrapR-data/master/legacy_data/season_play_by_play/pbp_2017.csv&#39;))</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">##write.csv(mydata3,&#39;2017playbyplay.csv&#39;)</span></a>
<a class="sourceLine" id="cb1-15" title="15"></a>
<a class="sourceLine" id="cb1-16" title="16">mydata3&lt;-<span class="kw">read.csv</span>(<span class="st">&#39;2017playbyplay.csv&#39;</span>)</a>
<a class="sourceLine" id="cb1-17" title="17"><span class="kw">nrow</span>(mydata3)</a>
<a class="sourceLine" id="cb1-18" title="18"><span class="kw">table</span>(mydata3<span class="op">$</span>Passer)</a>
<a class="sourceLine" id="cb1-19" title="19"><span class="kw">table</span>(mydata3<span class="op">$</span>PlayType)</a>
<a class="sourceLine" id="cb1-20" title="20"></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="co">#mydata5&lt;-mydata3[!duplicated(mydata3[,c(&#39;GameID&#39;,&#39;Passer&#39;)]),]</span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="co">#unique(mydata3$GameID)</span></a>
<a class="sourceLine" id="cb1-23" title="23">mydata6&lt;-<span class="kw">subset</span>(mydata3,down<span class="op">==</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-24" title="24"></a>
<a class="sourceLine" id="cb1-25" title="25"></a>
<a class="sourceLine" id="cb1-26" title="26">mydata7&lt;-<span class="kw">subset</span>(mydata6,PlayType<span class="op">==</span><span class="st">&#39;Pass&#39;</span><span class="op">|</span>PlayType<span class="op">==</span><span class="st">&#39;Run&#39;</span>)</a>
<a class="sourceLine" id="cb1-27" title="27"><span class="co">#table(mydata7$PlayType)</span></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="co">#table(droplevels(mydata7$PlayType))</span></a>
<a class="sourceLine" id="cb1-29" title="29"></a>
<a class="sourceLine" id="cb1-30" title="30">mydata7<span class="op">$</span>PlayType&lt;-<span class="kw">droplevels</span>(mydata7<span class="op">$</span>PlayType)</a>
<a class="sourceLine" id="cb1-31" title="31"><span class="kw">table</span>(mydata7<span class="op">$</span>PlayType)</a>
<a class="sourceLine" id="cb1-32" title="32"></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="co">#http://rstudio-pubs-static.s3.amazonaws.com/6975_c4943349b6174f448104a5513fed59a9.html</span></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="kw">source</span>(<span class="st">&quot;http://pcwww.liv.ac.uk/~william/R/crosstab.r&quot;</span>)</a>
<a class="sourceLine" id="cb1-35" title="35">mydata8&lt;-mydata7[,<span class="kw">c</span>(<span class="st">&#39;Passer&#39;</span>,<span class="st">&#39;PlayType&#39;</span>,<span class="st">&#39;GameID&#39;</span>,<span class="st">&#39;posteam&#39;</span>,<span class="st">&#39;DefensiveTeam&#39;</span>,<span class="st">&#39;Yards.Gained&#39;</span>,<span class="st">&#39;FirstDown&#39;</span>,<span class="st">&#39;TimeSecs&#39;</span>)]</a>
<a class="sourceLine" id="cb1-36" title="36"><span class="co">#results&lt;-crosstab(mydata8, row.vars = &quot;GameID&quot;, col.vars = &quot;PlayType&quot;, type = &quot;r&quot;)</span></a>
<a class="sourceLine" id="cb1-37" title="37"><span class="co">#p1&lt;-results$crosstab</span></a>
<a class="sourceLine" id="cb1-38" title="38"><span class="co">#hist(p1[,1],20)</span></a>
<a class="sourceLine" id="cb1-39" title="39"></a>
<a class="sourceLine" id="cb1-40" title="40"></a>
<a class="sourceLine" id="cb1-41" title="41"></a>
<a class="sourceLine" id="cb1-42" title="42"><span class="kw">library</span>(plyr)</a>
<a class="sourceLine" id="cb1-43" title="43">count_vector&lt;-<span class="kw">count</span>(mydata8, <span class="st">&quot;GameID&quot;</span>)</a>
<a class="sourceLine" id="cb1-44" title="44"></a>
<a class="sourceLine" id="cb1-45" title="45">l_new&lt;-<span class="kw">length</span>(count_vector<span class="op">$</span>freq)</a>
<a class="sourceLine" id="cb1-46" title="46">time&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb1-47" title="47"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>l_new)</a>
<a class="sourceLine" id="cb1-48" title="48">{time&lt;-<span class="kw">append</span>(time,<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>count_vector<span class="op">$</span>freq[i]))}</a>
<a class="sourceLine" id="cb1-49" title="49"><span class="kw">nrow</span>(time)</a>
<a class="sourceLine" id="cb1-50" title="50">mydata8<span class="op">$</span>time&lt;-time</a>
<a class="sourceLine" id="cb1-51" title="51">mydata8<span class="op">$</span>play_new&lt;-<span class="kw">ifelse</span>(mydata8<span class="op">$</span>PlayType<span class="op">==</span><span class="st">&#39;Pass&#39;</span>,<span class="dv">1</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1-52" title="52"></a>
<a class="sourceLine" id="cb1-53" title="53">n_counting&lt;-<span class="dv">0</span>  <span class="co"># help counting the number of pairs</span></a>
<a class="sourceLine" id="cb1-54" title="54"></a>
<a class="sourceLine" id="cb1-55" title="55"><span class="co">## The following code collects all the rows of each pair. However, it is difficult to analyze data</span></a>
<a class="sourceLine" id="cb1-56" title="56"><span class="co"># in such a format. </span></a>
<a class="sourceLine" id="cb1-57" title="57"></a>
<a class="sourceLine" id="cb1-58" title="58"><span class="co">#empty_df = mydata8[FALSE,]</span></a>
<a class="sourceLine" id="cb1-59" title="59"><span class="co">#for (i in 1:l_new) # level of different game</span></a>
<a class="sourceLine" id="cb1-60" title="60"><span class="co">#{</span></a>
<a class="sourceLine" id="cb1-61" title="61"><span class="co">#   for(j in 1:((count_vector$freq[i])-1)) # within the same game</span></a>
<a class="sourceLine" id="cb1-62" title="62"><span class="co">#   {</span></a>
<a class="sourceLine" id="cb1-63" title="63"><span class="co">#      if(i==1)</span></a>
<a class="sourceLine" id="cb1-64" title="64"><span class="co">#      {row_id&lt;-j}</span></a>
<a class="sourceLine" id="cb1-65" title="65"><span class="co">#      else {row_id&lt;-sum(count_vector$freq[1:(i-1)])+j}</span></a>
<a class="sourceLine" id="cb1-66" title="66"><span class="co">#</span></a>
<a class="sourceLine" id="cb1-67" title="67"><span class="co">#      #print(row_id)</span></a>
<a class="sourceLine" id="cb1-68" title="68"><span class="co">#      if(as.character(mydata8[row_id,]$posteam)!=as.character(mydata8[row_id+1,]$posteam))</span></a>
<a class="sourceLine" id="cb1-69" title="69"><span class="co">#      {</span></a>
<a class="sourceLine" id="cb1-70" title="70"><span class="co">#        print(&quot;not same team&quot;)</span></a>
<a class="sourceLine" id="cb1-71" title="71"><span class="co">#        if (nrow(empty_df)==0)</span></a>
<a class="sourceLine" id="cb1-72" title="72"><span class="co">#           {empty_df&lt;-mydata8[row_id:(row_id+1),]}</span></a>
<a class="sourceLine" id="cb1-73" title="73"><span class="co">#        else</span></a>
<a class="sourceLine" id="cb1-74" title="74"><span class="co">#           {</span></a>
<a class="sourceLine" id="cb1-75" title="75"><span class="co">#             if(row.names(mydata8[row_id,])!=row.names(tail(empty_df,1)))</span></a>
<a class="sourceLine" id="cb1-76" title="76"><span class="co">#               {empty_df&lt;-rbind(empty_df,mydata8[row_id,])}</span></a>
<a class="sourceLine" id="cb1-77" title="77"><span class="co">#             empty_df&lt;-rbind(empty_df,mydata8[row_id+1,])</span></a>
<a class="sourceLine" id="cb1-78" title="78"><span class="co">#           }</span></a>
<a class="sourceLine" id="cb1-79" title="79"><span class="co">#       n_counting&lt;-n_counting+1</span></a>
<a class="sourceLine" id="cb1-80" title="80"><span class="co">#      }</span></a>
<a class="sourceLine" id="cb1-81" title="81"><span class="co">#   }</span></a>
<a class="sourceLine" id="cb1-82" title="82"><span class="co">#}</span></a>
<a class="sourceLine" id="cb1-83" title="83"></a>
<a class="sourceLine" id="cb1-84" title="84"></a>
<a class="sourceLine" id="cb1-85" title="85"><span class="co"># The following code only collects the second row of the pair, but adds data of </span></a>
<a class="sourceLine" id="cb1-86" title="86"><span class="co">### PT_L: type of play in the last first down from the other team</span></a>
<a class="sourceLine" id="cb1-87" title="87"><span class="co">### TG_L: Yards.Gained in the last play</span></a>
<a class="sourceLine" id="cb1-88" title="88"><span class="co">### FirstDown: did they get first down or not. Note that, if yes, it means it was a fumble.</span></a>
<a class="sourceLine" id="cb1-89" title="89"></a>
<a class="sourceLine" id="cb1-90" title="90">PT_L=<span class="st">&quot;Pass&quot;</span></a>
<a class="sourceLine" id="cb1-91" title="91">TG_L=<span class="dv">0</span></a>
<a class="sourceLine" id="cb1-92" title="92">FD_L=<span class="dv">0</span></a>
<a class="sourceLine" id="cb1-93" title="93"></a>
<a class="sourceLine" id="cb1-94" title="94">pari_data=<span class="st"> </span>mydata8[<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb1-95" title="95">pari_data&lt;-<span class="kw">cbind</span>(pari_data,PT_L,TG_L,FD_L)</a>
<a class="sourceLine" id="cb1-96" title="96">pari_data&lt;-pari_data[<span class="ot">FALSE</span>,]</a>
<a class="sourceLine" id="cb1-97" title="97"></a>
<a class="sourceLine" id="cb1-98" title="98"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>l_new) <span class="co"># level of different game</span></a>
<a class="sourceLine" id="cb1-99" title="99">{</a>
<a class="sourceLine" id="cb1-100" title="100">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>((count_vector<span class="op">$</span>freq[i])<span class="op">-</span><span class="dv">1</span>)) <span class="co"># within the same game</span></a>
<a class="sourceLine" id="cb1-101" title="101">  {</a>
<a class="sourceLine" id="cb1-102" title="102"></a>
<a class="sourceLine" id="cb1-103" title="103">    <span class="cf">if</span>(i<span class="op">==</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-104" title="104">    {row_id&lt;-j}</a>
<a class="sourceLine" id="cb1-105" title="105">    <span class="cf">else</span> {row_id&lt;-<span class="kw">sum</span>(count_vector<span class="op">$</span>freq[<span class="dv">1</span><span class="op">:</span>(i<span class="dv">-1</span>)])<span class="op">+</span>j}</a>
<a class="sourceLine" id="cb1-106" title="106"></a>
<a class="sourceLine" id="cb1-107" title="107">    <span class="kw">print</span>(row_id)</a>
<a class="sourceLine" id="cb1-108" title="108">    <span class="cf">if</span>(<span class="kw">as.character</span>(mydata8[row_id,]<span class="op">$</span>posteam)<span class="op">!=</span><span class="kw">as.character</span>(mydata8[row_id<span class="op">+</span><span class="dv">1</span>,]<span class="op">$</span>posteam))</a>
<a class="sourceLine" id="cb1-109" title="109">    {</a>
<a class="sourceLine" id="cb1-110" title="110">      <span class="kw">print</span>(<span class="st">&quot;not same team&quot;</span>)</a>
<a class="sourceLine" id="cb1-111" title="111">      PT_L&lt;-<span class="kw">as.character</span>(mydata8[row_id,]<span class="op">$</span>PlayType)</a>
<a class="sourceLine" id="cb1-112" title="112">      TG_L&lt;-mydata8[row_id,]<span class="op">$</span>Yards.Gained</a>
<a class="sourceLine" id="cb1-113" title="113">      FD_L&lt;-mydata8[row_id,]<span class="op">$</span>FirstDown</a>
<a class="sourceLine" id="cb1-114" title="114"></a>
<a class="sourceLine" id="cb1-115" title="115">      new_row&lt;-<span class="kw">cbind</span>(mydata8[(row_id<span class="op">+</span><span class="dv">1</span>),],PT_L,TG_L,FD_L)</a>
<a class="sourceLine" id="cb1-116" title="116">      pari_data&lt;-<span class="kw">rbind</span>(pari_data,new_row)</a>
<a class="sourceLine" id="cb1-117" title="117">     }</a>
<a class="sourceLine" id="cb1-118" title="118"></a>
<a class="sourceLine" id="cb1-119" title="119">      n_counting&lt;-n_counting<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-120" title="120">  }</a>
<a class="sourceLine" id="cb1-121" title="121">}</a>
<a class="sourceLine" id="cb1-122" title="122"></a>
<a class="sourceLine" id="cb1-123" title="123">pari_data<span class="op">$</span>same&lt;-<span class="kw">ifelse</span>(pari_data<span class="op">$</span>PlayType<span class="op">==</span>pari_data<span class="op">$</span>PT_L,<span class="dv">1</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1-124" title="124"></a>
<a class="sourceLine" id="cb1-125" title="125"><span class="co">#write.csv(pari_data,&#39;pari_data.csv&#39;)</span></a>
<a class="sourceLine" id="cb1-126" title="126"></a>
<a class="sourceLine" id="cb1-127" title="127"><span class="kw">write.table</span>(pari_data, <span class="dt">file =</span> <span class="st">&quot;pari_data.csv&quot;</span>,<span class="dt">row.names=</span><span class="ot">FALSE</span>,<span class="dt">na =</span> <span class="st">&quot;&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</a></code></pre></div>
<p><strong>Remarks</strong></p>
<ol style="list-style-type: decimal">
<li><p>mylogit1: in general, a team has a different play in their first down, compared to the other team in the last first down.</p></li>
<li><p>mylogit2: If the defence team passed in the last first down, the offence team is less likely to use pass. If the defence team gained more yards, the offence team is more likely to pass in the next first down. If the defence team fumbled, it will reduce the chance the offence team to do the pass.</p></li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">pari_data2&lt;-<span class="kw">read.csv</span>(<span class="st">&#39;pari_data.csv&#39;</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3">mylogit1 =<span class="st"> </span><span class="kw">glm</span>(same<span class="op">~</span><span class="dv">1</span>, <span class="dt">family=</span>binomial, <span class="dt">data=</span>pari_data2)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">summary</span>(mylogit1)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = same ~ 1, family = binomial, data = pari_data2)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.117  -1.117  -1.117   1.239   1.239  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.14395    0.02809  -5.124    3e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 7035.5  on 5093  degrees of freedom
## Residual deviance: 7035.5  on 5093  degrees of freedom
## AIC: 7037.5
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">mylogit2 =<span class="st"> </span><span class="kw">glm</span>(play_new<span class="op">~</span>same<span class="op">+</span>TG_L<span class="op">+</span>FD_L, <span class="dt">family=</span>binomial, <span class="dt">data=</span>pari_data2)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">summary</span>(mylogit2)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = play_new ~ same + TG_L + FD_L, family = binomial, 
##     data = pari_data2)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6114  -0.9783  -0.9382   1.0995   1.5672  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.175629   0.040712   4.314  1.6e-05 ***
## same        -0.757822   0.057618 -13.152  &lt; 2e-16 ***
## TG_L         0.010439   0.003873   2.695  0.00704 ** 
## FD_L        -0.268115   0.148835  -1.801  0.07164 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 7034.3  on 5093  degrees of freedom
## Residual deviance: 6850.1  on 5090  degrees of freedom
## AIC: 6858.1
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">library</span>(lme4)</a></code></pre></div>
<pre><code>## Warning: package &#39;lme4&#39; was built under R version 3.6.2</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Warning: package &#39;Matrix&#39; was built under R version 3.6.1</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">mylogit3 =<span class="st"> </span><span class="kw">glmer</span>(same<span class="op">~</span>play_new<span class="op">+</span>TG_L<span class="op">+</span>FD_L<span class="op">+</span>(<span class="dv">1</span><span class="op">|</span>GameID), <span class="dt">family=</span> <span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>), <span class="dt">data=</span>pari_data2)</a></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">summary</span>(mylogit3)</a></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: same ~ play_new + TG_L + FD_L + (1 | GameID)
##    Data: pari_data2
## 
##      AIC      BIC   logLik deviance df.resid 
##   6862.4   6895.1  -3426.2   6852.4     5089 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.3918 -0.7763 -0.7532  0.9061  1.6255 
## 
## Random effects:
##  Groups Name        Variance  Std.Dev. 
##  GameID (Intercept) 1.562e-15 3.953e-08
## Number of obs: 5094, groups:  GameID, 256
## 
## Fixed effects:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.197140   0.040513   4.866 1.14e-06 ***
## play_new    -0.757838   0.057619 -13.153  &lt; 2e-16 ***
## TG_L         0.006027   0.003824   1.576  0.11502    
## FD_L        -0.392792   0.150715  -2.606  0.00916 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##          (Intr) ply_nw TG_L  
## play_new -0.627              
## TG_L     -0.270 -0.043       
## FD_L     -0.147  0.031 -0.041
## convergence code: 0
## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co">#Bill_1&lt;- bild(play_new ~ TG_L+FD_L, data = mydata8, id=&quot;GameID&quot;,start = NULL, dependence = &quot;MC1R&quot;)</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co">#summary(Bill_1)</span></a>
<a class="sourceLine" id="cb14-3" title="3"></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co">#locust2 &lt;- bild(as.factor(PlayType) ~ time + I(time^2), data = mydata8,id=&quot;GameID&quot;,start = NULL, dependence = &quot;MC2&quot;)</span></a></code></pre></div>
</div>
<div id="references" class="section level2">
<h2><span class="header-section-number">1.2</span> References</h2>
<p><a href="https://arxiv.org/pdf/1403.7993.pdf" class="uri">https://arxiv.org/pdf/1403.7993.pdf</a></p>
<p><a href="http://www.dartmouth.edu/~chance/teaching_aids/books_articles/probability_book/Chapter11.pdf" class="uri">http://www.dartmouth.edu/~chance/teaching_aids/books_articles/probability_book/Chapter11.pdf</a></p>
<p><a href="https://rpubs.com/JanpuHou/326048" class="uri">https://rpubs.com/JanpuHou/326048</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="project-draft.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/21-Football.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
